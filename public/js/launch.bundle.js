!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=732)}({178:function(e,t,n){"use strict";var r={};r.getUrlParameter=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]===e){var o=r[1].replace(/\+/g,"%20");return decodeURIComponent(o)}}},t.a=r},25:function(e,t,n){"use strict";function r(e,t){for(var n in e)if(e.hasOwnProperty(n)&&n.toString().startsWith(t))return e[n]}function o(e,t,n){if(e.startsWith("http")){var r=e.lastIndexOf("/"),o=e.lastIndexOf("/",r-1)+1;return t+n+"/"+e.substr(o,r-o)+"?url="+e}return t+n+"/"+e}function i(e,t){var n=new XMLHttpRequest;n.open("POST","../db/logs"),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){t(JSON.parse(n.responseText))},n.send(JSON.stringify(e))}function a(e){var t=new XMLHttpRequest;t.open("PUT","../db/logs/"+e.id),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify(e))}function s(e,t){u(function(n){var r=n.filter(function(t){return e.name===t.name});if(r.length){var o=new XMLHttpRequest;o.open("PUT","../db/clients/"+r[0].id),o.setRequestHeader("Content-Type","application/json"),o.onload=function(){t(JSON.parse(o.responseText))},o.send(JSON.stringify(e))}else{var i=new XMLHttpRequest;i.open("POST","../db/clients"),i.setRequestHeader("Content-Type","application/json"),i.onload=function(){t(JSON.parse(i.responseText))},i.send(JSON.stringify(e))}})}function c(e,t){var n=new XMLHttpRequest;n.open("DELETE","../db/clients/"+e),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){t()},n.send()}function u(e){var t=new XMLHttpRequest;t.open("GET","../db/clients/"),t.setRequestHeader("Content-Type","application/json"),t.onload=function(){e(JSON.parse(t.responseText))},t.send()}function d(e,t){var n=e;if(e.item)e.item.forEach(function(e){d(e,t),console.log(e)});else if(t.find(function(t){return t===e.linkId}))return e.answer.push({valueCoding:{code:"410515003",system:"http://snomed.info/sct",display:"known present"}});return n}n.d(t,"c",function(){return r}),n.d(t,"f",function(){return i}),n.d(t,"h",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"a",function(){return o})},732:function(e,t,n){"use strict";n.r(t);var r=n(178),o=n(25),i=[];Object(o.d)(function(e){i=e.reduce(function(e,t){return e[t.name]=t.client,e},{}),Object(o.f)(a,c)});var a={status:"launching"},s=null;function c(e){e.status="fetch clients";var t="7c47a01b-b7d8-41cf-a290-8ed607108e70";if(localStorage.setItem("lastAccessedServiceUri",e.serviceUri),i)if(i[e.serviceUri])t=i[e.serviceUri];else if(i.default)t=i.default;else{e.error="no client id found in local storage, please go to the /register page to register a client id, or verify that the default clientId string in the code is correctly typed.",Object(o.h)(e)}else e.error="unable to access clients",Object(o.h)(e);e.clientId=t,e.scope=["launch","user/Observation.read","user/Patient.read","patient/Observation.read","patient/Patient.read","patient/Coverage.read","patient/Condition.read","user/Practitioner.read"].join(" ");var n=Math.round(1e8*Math.random()).toString(),r=window.location.protocol+"//"+window.location.host+window.location.pathname;e.redirectUri=r.replace("launch","index"),e.status="retrieving conformance statement",Object(o.h)(e);var a,c=e.serviceUri+"/metadata?_format=json",u=new XMLHttpRequest;u.open("GET",c),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Accept","application/json"),u.onload=function(){if(200!==u.status)return e.error="Conformance statement request failed. Returned status: "+u.status,Object(o.h)(e),void(document.body.innerText=e.error);try{a=JSON.parse(u.responseText)}catch(t){return e.error="Unable to parse conformance statement.",Object(o.h)(e),void(document.body.innerText=e.error)}!function(r){var i,a;e.status="redirecting",Object(o.h)(e),r.rest[0].security.extension.filter(function(e){return"http://fhir-registry.smarthealthit.org/StructureDefinition/oauth-uris"===e.url})[0].extension.forEach(function(e){"authorize"===e.url?i=e.valueUri:"token"===e.url&&(a=e.valueUri)}),sessionStorage[n]=JSON.stringify({clientId:t,secret:s,serviceUri:e.serviceUri,redirectUri:e.redirectUri,tokenUri:a,log:e});var c=i+"?response_type=code&client_id="+encodeURIComponent(t)+"&scope="+encodeURIComponent(e.scope)+"&redirect_uri="+encodeURIComponent(e.redirectUri)+"&aud="+encodeURIComponent(e.serviceUri)+"&state="+n;e.launchContextId&&(c+="&launch="+encodeURIComponent(e.launchContextId));window.location.href=c}(a)},u.send()}a.launchContextId=r.a.getUrlParameter("launch"),a.serviceUri=r.a.getUrlParameter("iss")}});